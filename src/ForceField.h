//
// Created by Alia Lescoulie on 5/14/22.
//

#ifndef MD_LAB_FORCEFIELD_H
#define MD_LAB_FORCEFIELD_H

#include "CubicBox.h"

#include <cmath>
#include <map>

const double lj_sig[] = {0.5523570,
                         0.4989030,
                         2.2807000,
                         1.7105300,
                         1.5145300,
                         1.3541700,
                         1.2650800,
                         1.1759900,
                         1.0156200,
                         1.0334400,
                         2.9577800,
                         2.5123300,
                         2.1559700,
                         1.9778000,
                         1.9065200,
                         1.8708900,
                         1.8174300,
                         1.8887100,
                         3.6170500,
                         3.1359600,
                         3.0290600,
                         2.8508800,
                         2.7261500,
                         2.4767000,
                         2.4767000,
                         2.3519700,
                         2.2450600,
                         2.2094300,
                         2.3519700,
                         2.1737900,
                         2.1737900,
                         2.1381600,
                         2.1203400,
                         2.1381600,
                         2.1381600,
                         2.0668900,
                         3.9199500,
                         3.4745100,
                         3.3854200,
                         3.1181500,
                         2.9221500,
                         2.7439700,
                         2.6192400,
                         2.6014200,
                         2.5301500,
                         2.4767000,
                         2.5836100,
                         2.5657900,
                         2.5301500,
                         2.4767000,
                         2.4767000,
                         2.4588800,
                         2.4767000,
                         2.4945200,
                         4.3475900,
                         3.8308600,
                         3.6883200,
                         3.6348700,
                         3.6170500,
                         3.5814100,
                         3.5457800,
                         3.5279600,
                         3.5279600,
                         3.4923200,
                         3.4566900,
                         3.4210500,
                         3.4210500,
                         3.3676000,
                         3.3854200,
                         3.3319600,
                         3.3319600,
                         3.1181500,
                         3.0290600,
                         2.8865100,
                         2.6905100,
                         2.5657900,
                         2.5123300,
                         2.4232400,
                         2.4232400,
                         2.3519700,
                         2.5836100,
                         2.6014200,
                         2.6370600,
                         2.4945200,
                         2.6727000,
                         2.6727000,
                         4.6326700,
                         3.9377700,
                         3.8308600,
                         3.6705000,
                         3.5635900,
                         3.4923200,
                         3.3854200,
                         3.3319600,
                         3.2072400,
                         3.0112400,
                         2.9934200,
                         2.9934200,
                         2.9399700,
                         2.9756000,
                         3.0825100,
                         3.1359600,
                         2.8686900,
                         2.7974200,
                         2.6548800,
                         2.5479700,
                         2.5123300,
                         2.3876100,
                         2.2985200,
                         2.2807000,
                         2.1559700,
                         2.1737900,
                         2.4232400,
                         2.5479700,
                         2.8865100,
                         3.1181500,
                         2.9399700,
                         2.7974200};

const double lj_epsilon[] = {4.4778900,
                             0.0009421,
                             1.0496900,
                             0.5729420,
                             2.9670300,
                             6.3695300,
                             9.7537900,
                             5.1264700,
                             1.6059200,
                             0.0036471,
                             0.7367450,
                             0.0785788,
                             2.7006700,
                             3.1743100,
                             5.0305000,
                             4.3692700,
                             4.4832800,
                             0.0123529,
                             0.5517990,
                             0.1326790,
                             1.6508000,
                             1.1802700,
                             2.7524900,
                             1.5367900,
                             0.5998880,
                             1.1844200,
                             1.2776900,
                             2.0757200,
                             2.0446300,
                             0.1915460,
                             1.0642000,
                             2.7017100,
                             3.9599000,
                             3.3867700,
                             1.9706300,
                             0.0173276,
                             0.4682650,
                             0.1339230,
                             2.7597500,
                             3.0520100,
                             5.2782000,
                             4.4749900,
                             3.3815900,
                             1.9617200,
                             2.4058200,
                             1.3709700,
                             1.6497600,
                             0.0377447,
                             0.8113140,
                             1.9005700,
                             3.0882800,
                             2.6312300,
                             1.5393800,
                             0.0238880,
                             0.4166420,
                             1.9000000,
                             2.4996100,
                             2.5700800,
                             1.2994600,
                             0.8196050,
                             3.2413400,
                             0.5211220,
                             0.4299180,
                             2.0995600,
                             1.3999900,
                             0.6900550,
                             0.6900550,
                             0.7387660,
                             0.5211220,
                             0.1303990,
                             1.4331500,
                             3.3608600,
                             4.0034300,
                             6.8638900,
                             4.4387100,
                             4.2625300,
                             3.7028700,
                             3.1401000,
                             2.3058000,
                             0.0454140,
                             0.5770870,
                             0.8589880,
                             2.0798700,
                             1.8995300,
                             1.3854420,
                             0.0214992,
                             0.3749778,
                             1.7100000,
                             2.2496490,
                             2.3130720,
                             1.1695140,
                             0.7376445,
                             2.9172060,
                             0.4690098,
                             0.3869262,
                             1.8896040,
                             1.2599910,
                             0.6210495,
                             0.6210495,
                             0.6648894,
                             0.4690098,
                             0.1173591,
                             1.2898350,
                             3.0247740,
                             3.6030870,
                             6.1775010,
                             3.9948390,
                             3.8362770,
                             3.3325830,
                             2.8260900,
                             2.0752200,
                             0.0408726,
                             0.5193783,
                             0.7730892,
                             1.8718830,
                             1.7095770,
                             1.2468978,
                             0.0193493};


class ForceField {
private:
    double dt;
    double** calc_dists();
    CubicBox* box = nullptr;
    Boundary* bounds;
    double cutoff = 1.75;
    std::map<std::string, int> id_table;
    std::map<std::string, int> init_id_table();
    double lj_pot(double r, double s, double e);
    double eps_ij(int i, int j);
    double sig_ij(int i, int j);
public:
    ForceField(double dt, Boundary* bounds);
    void add_box(CubicBox* box);
    void run_forces();

};


#endif //MD_LAB_FORCEFIELD_H
